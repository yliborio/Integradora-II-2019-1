| select `tpch`.`lineitem`.`l_returnflag` AS `l_returnflag`,`tpch`.`lineitem`.`l_linestatus` AS `l_linestatus`,sum(`tpch`.`lineitem`.`l_quantity`) AS `sum_qty`,sum(`tpch`.`lineitem`.`l_extendedprice`) AS `sum_base_price`,sum((`tpch`.`lineitem`.`l_extendedprice` * (1 - `tpch`.`lineitem`.`l_discount`))) AS `sum_disc_price`,sum(((`tpch`.`lineitem`.`l_extendedprice` * (1 - `tpch`.`lineitem`.`l_discount`)) * (1 + `tpch`.`lineitem`.`l_tax`))) AS `sum_charge`,avg(`tpch`.`lineitem`.`l_quantity`) AS `avg_qty`,avg(`tpch`.`lineitem`.`l_extendedprice`) AS `avg_price`,avg(`tpch`.`lineitem`.`l_discount`) AS `avg_disc`,count(0) AS `count_order` from `tpch`.`lineitem` where (`tpch`.`lineitem`.`l_shipdate` <= (DATE'1994-07-17' - interval '108' day)) group by `tpch`.`lineitem`.`l_returnflag`,`tpch`.`lineitem`.`l_linestatus` order by `tpch`.`lineitem`.`l_returnflag`,`tpch`.`lineitem`.`l_linestatus`                                                                                                                                       |
| select `tpch`.`customer`.`c_custkey` AS `c_custkey`,`tpch`.`customer`.`c_name` AS `c_name`,sum((`tpch`.`lineitem`.`l_extendedprice` * (1 - `tpch`.`lineitem`.`l_discount`))) AS `revenue`,`tpch`.`customer`.`c_acctbal` AS `c_acctbal`,`tpch`.`nation`.`n_name` AS `n_name`,`tpch`.`customer`.`c_address` AS `c_address`,`tpch`.`customer`.`c_phone` AS `c_phone`,`tpch`.`customer`.`c_comment` AS `c_comment` from `tpch`.`customer` join `tpch`.`orders` join `tpch`.`lineitem` join `tpch`.`nation` where ((`tpch`.`customer`.`c_custkey` = `tpch`.`orders`.`o_custkey`) and (`tpch`.`lineitem`.`l_orderkey` = `tpch`.`orders`.`o_orderkey`) and (`tpch`.`orders`.`o_orderdate` >= DATE'1993-08-01') and (`tpch`.`orders`.`o_orderdate` < (DATE'1993-08-01' + interval '3' month)) and (`tpch`.`lineitem`.`l_returnflag` = 'R') and (`tpch`.`customer`.`c_nationkey` = `tpch`.`nation`.`n_nationkey`)) group by `tpch`.`customer`.`c_custkey`,`tpch`.`customer`.`c_name`,`tpch`.`customer`.`c_acctbal`,`tpch`.`customer`.`c_phone`,`tpch`.`nation`.`n_name`,`tpch`.`customer`.`c_address`,`tpch`.`customer`.`c_comment` order by `revenue` desc limit 20 |
| select `tpch`.`partsupp`.`ps_partkey` AS `ps_partkey`,sum((`tpch`.`partsupp`.`ps_supplycost` * `tpch`.`partsupp`.`ps_availqty`)) AS `value` from `tpch`.`partsupp` join `tpch`.`supplier` join `tpch`.`nation` where ((`tpch`.`partsupp`.`ps_suppkey` = `tpch`.`supplier`.`s_suppkey`) and (`tpch`.`supplier`.`s_nationkey` = `tpch`.`nation`.`n_nationkey`) and (`tpch`.`nation`.`n_name` = 'MOZAMBIQUE')) group by `tpch`.`partsupp`.`ps_partkey` having (sum((`tpch`.`partsupp`.`ps_supplycost` * `tpch`.`partsupp`.`ps_availqty`)) > (select (sum((`tpch`.`partsupp`.`ps_supplycost` * `tpch`.`partsupp`.`ps_availqty`)) * 0.0001000000) from `tpch`.`partsupp` join `tpch`.`supplier` join `tpch`.`nation` where ((`tpch`.`partsupp`.`ps_suppkey` = `tpch`.`supplier`.`s_suppkey`) and (`tpch`.`supplier`.`s_nationkey` = `tpch`.`nation`.`n_nationkey`) and (`tpch`.`nation`.`n_name` = 'MOZAMBIQUE')))) order by `value` desc                                                                                                                             |
| select `tpch`.`lineitem`.`l_shipmode` AS `l_shipmode`,sum((case when ((`tpch`.`orders`.`o_orderpriority` = '1-URGENT') or (`tpch`.`orders`.`o_orderpriority` = '2-HIGH')) then 1 else 0 end)) AS `high_line_count`,sum((case when ((`tpch`.`orders`.`o_orderpriority` <> '1-URGENT') and (`tpch`.`orders`.`o_orderpriority` <> '2-HIGH')) then 1 else 0 end)) AS `low_line_count` from `tpch`.`orders` join `tpch`.`lineitem` where ((`tpch`.`orders`.`o_orderkey` = `tpch`.`lineitem`.`l_orderkey`) and (`tpch`.`lineitem`.`l_shipmode` in ('RAIL','FOB')) and (`tpch`.`lineitem`.`l_commitdate` < `tpch`.`lineitem`.`l_receiptdate`) and (`tpch`.`lineitem`.`l_shipdate` < `tpch`.`lineitem`.`l_commitdate`) and (`tpch`.`lineitem`.`l_receiptdate` >= DATE'1997-01-01') and (`tpch`.`lineitem`.`l_receiptdate` < (DATE'1997-01-01' + interval '1' year))) group by `tpch`.`lineitem`.`l_shipmode` order by `tpch`.`lineitem`.`l_shipmode`                                                                                                                     |
| select `c_orders`.`c_count` AS `c_count`,count(0) AS `custdist` from (select `tpch`.`customer`.`c_custkey` AS `c_custkey`,count(`tpch`.`orders`.`o_orderkey`) AS `c_count` from (`tpch`.`customer` left join `tpch`.`orders` on(((`tpch`.`customer`.`c_custkey` = `tpch`.`orders`.`o_custkey`) and (not((`tpch`.`orders`.`o_comment` like '%pending%deposits%')))))) group by `tpch`.`customer`.`c_custkey`) `c_orders` group by `c_orders`.`c_count` order by `custdist` desc,`c_orders`.`c_count` desc                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| select ((100.00 * sum((case when (`tpch`.`part`.`p_type` like 'PROMO%') then (`tpch`.`lineitem`.`l_extendedprice` * (1 - `tpch`.`lineitem`.`l_discount`)) else 0 end))) / sum((`tpch`.`lineitem`.`l_extendedprice` * (1 - `tpch`.`lineitem`.`l_discount`)))) AS `promo_revenue` from `tpch`.`lineitem` join `tpch`.`part` where ((`tpch`.`lineitem`.`l_partkey` = `tpch`.`part`.`p_partkey`) and (`tpch`.`lineitem`.`l_shipdate` >= DATE'1996-12-01') and (`tpch`.`lineitem`.`l_shipdate` < (DATE'1996-12-01' + interval '1' month)))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| select `tpch`.`supplier`.`s_suppkey` AS `s_suppkey`,`tpch`.`supplier`.`s_name` AS `s_name`,`tpch`.`supplier`.`s_address` AS `s_address`,`tpch`.`supplier`.`s_phone` AS `s_phone`,`revenue0`.`total_revenue` AS `total_revenue` from `tpch`.`supplier` join `tpch`.`revenue0` where ((`tpch`.`supplier`.`s_suppkey` = `revenue0`.`supplier_no`) and (`revenue0`.`total_revenue` = (select max(`revenue0`.`total_revenue`) from `tpch`.`revenue0`))) order by `tpch`.`supplier`.`s_suppkey`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| select `tpch`.`part`.`p_brand` AS `p_brand`,`tpch`.`part`.`p_type` AS `p_type`,`tpch`.`part`.`p_size` AS `p_size`,count(distinct `tpch`.`partsupp`.`ps_suppkey`) AS `supplier_cnt` from `tpch`.`partsupp` join `tpch`.`part` where ((`tpch`.`part`.`p_partkey` = `tpch`.`partsupp`.`ps_partkey`) and (`tpch`.`part`.`p_brand` <> 'Brand#34') and (not((`tpch`.`part`.`p_type` like 'LARGE BRUSHED%'))) and (`tpch`.`part`.`p_size` in (48,19,12,4,41,7,21,39)) and (not(`tpch`.`partsupp`.`ps_suppkey` in (select `tpch`.`supplier`.`s_suppkey` from `tpch`.`supplier` where (`tpch`.`supplier`.`s_comment` like '%Customer%Complaints%'))))) group by `tpch`.`part`.`p_brand`,`tpch`.`part`.`p_type`,`tpch`.`part`.`p_size` order by `supplier_cnt` desc,`tpch`.`part`.`p_brand`,`tpch`.`part`.`p_type`,`tpch`.`part`.`p_size`                                                                                                                                                                                                                                  |
| select (sum(`tpch`.`lineitem`.`l_extendedprice`) / 7.0) AS `avg_yearly` from `tpch`.`lineitem` join `tpch`.`part` where ((`tpch`.`part`.`p_partkey` = `tpch`.`lineitem`.`l_partkey`) and (`tpch`.`part`.`p_brand` = 'Brand#44') and (`tpch`.`part`.`p_container` = 'WRAP PKG') and (`tpch`.`lineitem`.`l_quantity` < (select (0.2 * avg(`tpch`.`lineitem`.`l_quantity`)) from `tpch`.`lineitem` where (`tpch`.`lineitem`.`l_partkey` = `tpch`.`part`.`p_partkey`))))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| select `tpch`.`customer`.`c_name` AS `c_name`,`tpch`.`customer`.`c_custkey` AS `c_custkey`,`tpch`.`orders`.`o_orderkey` AS `o_orderkey`,`tpch`.`orders`.`o_orderdate` AS `o_orderdate`,`tpch`.`orders`.`o_totalprice` AS `o_totalprice`,sum(`tpch`.`lineitem`.`l_quantity`) AS `sum(l_quantity)` from `tpch`.`customer` join `tpch`.`orders` join `tpch`.`lineitem` where (`tpch`.`orders`.`o_orderkey` in (select `tpch`.`lineitem`.`l_orderkey` from `tpch`.`lineitem` group by `tpch`.`lineitem`.`l_orderkey` having (sum(`tpch`.`lineitem`.`l_quantity`) > 314)) and (`tpch`.`customer`.`c_custkey` = `tpch`.`orders`.`o_custkey`) and (`tpch`.`orders`.`o_orderkey` = `tpch`.`lineitem`.`l_orderkey`)) group by `tpch`.`customer`.`c_name`,`tpch`.`customer`.`c_custkey`,`tpch`.`orders`.`o_orderkey`,`tpch`.`orders`.`o_orderdate`,`tpch`.`orders`.`o_totalprice` order by `tpch`.`orders`.`o_totalprice` desc,`tpch`.`orders`.`o_orderdate` limit 100                                                                                                     |
| select sum((`tpch`.`lineitem`.`l_extendedprice` * (1 - `tpch`.`lineitem`.`l_discount`))) AS `revenue` from `tpch`.`lineitem` join `tpch`.`part` where (((`tpch`.`part`.`p_partkey` = `tpch`.`lineitem`.`l_partkey`) and (`tpch`.`part`.`p_brand` = 'Brand#52') and (`tpch`.`part`.`p_container` in ('SM CASE','SM BOX','SM PACK','SM PKG')) and (`tpch`.`lineitem`.`l_quantity` >= 4) and (`tpch`.`lineitem`.`l_quantity` <= (4 + 10)) and (`tpch`.`part`.`p_size` between 1 and 5) and (`tpch`.`lineitem`.`l_shipmode` in ('AIR','AIR REG')) and (`tpch`.`lineitem`.`l_shipinstruct` = 'DELIVER IN PERSON')) or ((`tpch`.`part`.`p_partkey` = `tpch`.`lineitem`.`l_partkey`) and (`tpch`.`part`.`p_brand` = 'Brand#11') and (`tpch`.`part`.`p_container` in ('MED BAG','MED BOX','MED PKG','MED PACK')) and (`tpch`.`lineitem`.`l_quantity` >= 18) and (`tpch`.`lineitem`.`l_quantity` <= (18 + 10)) and (`tpch`.`part`.`p_size` between 1 and 10) and (`tpch`.`lineitem`.`l_shipmode` in ('AIR','AIR REG')) and (`tpch`.`lineitem`.`l_shipinstruct` = 'DELIVER IN PERSON')) or ((`tpch`.`part`.`p_partkey` = `tpch`.`lineitem`.`l_partkey`) and (`tpch`.`part`.`p_brand` = 'Brand#51') and (`tpch`.`part`.`p_container` in ('LG CASE','LG BOX','LG PACK','LG PKG')) and (`tpch`.`lineitem`.`l_quantity` >= 29) and (`tpch`.`lineitem`.`l_quantity` <= (29 + 10)) and (`tpch`.`part`.`p_size` between 1 and 15) and (`tpch`.`lineitem`.`l_shipmode` in ('AIR','AIR REG')) and (`tpch`.`lineitem`.`l_shipinstruct` = 'DELIVER IN PERSON'))) |
| select `tpch`.`supplier`.`s_acctbal` AS `s_acctbal`,`tpch`.`supplier`.`s_name` AS `s_name`,`tpch`.`nation`.`n_name` AS `n_name`,`tpch`.`part`.`p_partkey` AS `p_partkey`,`tpch`.`part`.`p_mfgr` AS `p_mfgr`,`tpch`.`supplier`.`s_address` AS `s_address`,`tpch`.`supplier`.`s_phone` AS `s_phone`,`tpch`.`supplier`.`s_comment` AS `s_comment` from `tpch`.`part` join `tpch`.`supplier` join `tpch`.`partsupp` join `tpch`.`nation` join `tpch`.`region` where ((`tpch`.`part`.`p_partkey` = `tpch`.`partsupp`.`ps_partkey`) and (`tpch`.`supplier`.`s_suppkey` = `tpch`.`partsupp`.`ps_suppkey`) and (`tpch`.`part`.`p_size` = 30) and (`tpch`.`part`.`p_type` like '%STEEL') and (`tpch`.`supplier`.`s_nationkey` = `tpch`.`nation`.`n_nationkey`) and (`tpch`.`nation`.`n_regionkey` = `tpch`.`region`.`r_regionkey`) and (`tpch`.`region`.`r_name` = 'ASIA') and (`tpch`.`partsupp`.`ps_supplycost` = (select min(`tpch`.`partsupp`.`ps_supplycost`) from `tpch`.`partsupp` join `tpch`.`supplier` join `tpch`.`nation` join `tpch`.`region` where ((`tpch`.`part`.`p_partkey` = `tpch`.`partsupp`.`ps_partkey`) and (`tpch`.`supplier`.`s_suppkey` = `tpch`.`partsupp`.`ps_suppkey`) and (`tpch`.`supplier`.`s_nationkey` = `tpch`.`nation`.`n_nationkey`) and (`tpch`.`nation`.`n_regionkey` = `tpch`.`region`.`r_regionkey`) and (`tpch`.`region`.`r_name` = 'ASIA'))))) order by `tpch`.`supplier`.`s_acctbal` desc,`tpch`.`nation`.`n_name`,`tpch`.`supplier`.`s_name`,`tpch`.`part`.`p_partkey` limit 100 |
| select `tpch`.`supplier`.`s_name` AS `s_name`,`tpch`.`supplier`.`s_address` AS `s_address` from `tpch`.`supplier` join `tpch`.`nation` where (`tpch`.`supplier`.`s_suppkey` in (select `tpch`.`partsupp`.`ps_suppkey` from `tpch`.`partsupp` where (`tpch`.`partsupp`.`ps_partkey` in (select `tpch`.`part`.`p_partkey` from `tpch`.`part` where (`tpch`.`part`.`p_name` like 'green%')) and (`tpch`.`partsupp`.`ps_availqty` > (select (0.5 * sum(`tpch`.`lineitem`.`l_quantity`)) from `tpch`.`lineitem` where ((`tpch`.`lineitem`.`l_partkey` = `tpch`.`partsupp`.`ps_partkey`) and (`tpch`.`lineitem`.`l_suppkey` = `tpch`.`partsupp`.`ps_suppkey`) and (`tpch`.`lineitem`.`l_shipdate` >= DATE'1993-01-01') and (`tpch`.`lineitem`.`l_shipdate` < (DATE'1993-01-01' + interval '1' year))))))) and (`tpch`.`supplier`.`s_nationkey` = `tpch`.`nation`.`n_nationkey`) and (`tpch`.`nation`.`n_name` = 'ALGERIA')) order by `tpch`.`supplier`.`s_name`                                                                                                        |
| select `tpch`.`supplier`.`s_name` AS `s_name`,count(0) AS `numwait` from `tpch`.`supplier` join `tpch`.`lineitem` `l1` join `tpch`.`orders` join `tpch`.`nation` where ((`tpch`.`supplier`.`s_suppkey` = `l1`.`l_suppkey`) and (`tpch`.`orders`.`o_orderkey` = `l1`.`l_orderkey`) and (`tpch`.`orders`.`o_orderstatus` = 'F') and (`l1`.`l_receiptdate` > `l1`.`l_commitdate`) and exists(select 1 from `tpch`.`lineitem` `l2` where ((`l2`.`l_orderkey` = `l1`.`l_orderkey`) and (`l2`.`l_suppkey` <> `l1`.`l_suppkey`))) and (not(exists(select 1 from `tpch`.`lineitem` `l3` where ((`l3`.`l_orderkey` = `l1`.`l_orderkey`) and (`l3`.`l_suppkey` <> `l1`.`l_suppkey`) and (`l3`.`l_receiptdate` > `l3`.`l_commitdate`))))) and (`tpch`.`supplier`.`s_nationkey` = `tpch`.`nation`.`n_nationkey`) and (`tpch`.`nation`.`n_name` = 'EGYPT')) group by `tpch`.`supplier`.`s_name` order by `numwait` desc,`tpch`.`supplier`.`s_name` limit 100                                                                                                                  |
| select `custsale`.`cntrycode` AS `cntrycode`,count(0) AS `numcust`,sum(`custsale`.`c_acctbal`) AS `totacctbal` from (select substr(`tpch`.`customer`.`c_phone`,1,2) AS `cntrycode`,`tpch`.`customer`.`c_acctbal` AS `c_acctbal` from `tpch`.`customer` where ((substr(`tpch`.`customer`.`c_phone`,1,2) in ('20','40','22','30','39','42','21')) and (`tpch`.`customer`.`c_acctbal` > (select avg(`tpch`.`customer`.`c_acctbal`) from `tpch`.`customer` where ((`tpch`.`customer`.`c_acctbal` > 0.00) and (substr(`tpch`.`customer`.`c_phone`,1,2) in ('20','40','22','30','39','42','21'))))) and (not(exists(select 1 from `tpch`.`orders` where (`tpch`.`orders`.`o_custkey` = `tpch`.`customer`.`c_custkey`)))))) `custsale` group by `custsale`.`cntrycode` order by `custsale`.`cntrycode`                                                                                                                                                                                                                                                                  |
| select `tpch`.`lineitem`.`l_orderkey` AS `l_orderkey`,sum((`tpch`.`lineitem`.`l_extendedprice` * (1 - `tpch`.`lineitem`.`l_discount`))) AS `revenue`,`tpch`.`orders`.`o_orderdate` AS `o_orderdate`,`tpch`.`orders`.`o_shippriority` AS `o_shippriority` from `tpch`.`customer` join `tpch`.`orders` join `tpch`.`lineitem` where ((`tpch`.`customer`.`c_mktsegment` = 'AUTOMOBILE') and (`tpch`.`customer`.`c_custkey` = `tpch`.`orders`.`o_custkey`) and (`tpch`.`lineitem`.`l_orderkey` = `tpch`.`orders`.`o_orderkey`) and (`tpch`.`orders`.`o_orderdate` < DATE'1995-03-13') and (`tpch`.`lineitem`.`l_shipdate` > DATE'1995-03-13')) group by `tpch`.`lineitem`.`l_orderkey`,`tpch`.`orders`.`o_orderdate`,`tpch`.`orders`.`o_shippriority` order by `revenue` desc,`tpch`.`orders`.`o_orderdate` limit 10                                                                                                                                                                                                                                                 |
| select `tpch`.`orders`.`o_orderpriority` AS `o_orderpriority`,count(0) AS `order_count` from `tpch`.`orders` where ((`tpch`.`orders`.`o_orderdate` >= DATE'1995-01-01') and (`tpch`.`orders`.`o_orderdate` < (DATE'1995-01-01' + interval '3' month)) and exists(select 1 from `tpch`.`lineitem` where ((`tpch`.`lineitem`.`l_orderkey` = `tpch`.`orders`.`o_orderkey`) and (`tpch`.`lineitem`.`l_commitdate` < `tpch`.`lineitem`.`l_receiptdate`)))) group by `tpch`.`orders`.`o_orderpriority` order by `tpch`.`orders`.`o_orderpriority`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| select `tpch`.`nation`.`n_name` AS `n_name`,sum((`tpch`.`lineitem`.`l_extendedprice` * (1 - `tpch`.`lineitem`.`l_discount`))) AS `revenue` from `tpch`.`customer` join `tpch`.`orders` join `tpch`.`lineitem` join `tpch`.`supplier` join `tpch`.`nation` join `tpch`.`region` where ((`tpch`.`customer`.`c_custkey` = `tpch`.`orders`.`o_custkey`) and (`tpch`.`lineitem`.`l_orderkey` = `tpch`.`orders`.`o_orderkey`) and (`tpch`.`lineitem`.`l_suppkey` = `tpch`.`supplier`.`s_suppkey`) and (`tpch`.`customer`.`c_nationkey` = `tpch`.`supplier`.`s_nationkey`) and (`tpch`.`supplier`.`s_nationkey` = `tpch`.`nation`.`n_nationkey`) and (`tpch`.`nation`.`n_regionkey` = `tpch`.`region`.`r_regionkey`) and (`tpch`.`region`.`r_name` = 'MIDDLE EAST') and (`tpch`.`orders`.`o_orderdate` >= DATE'1994-01-01') and (`tpch`.`orders`.`o_orderdate` < (DATE'1994-01-01' + interval '1' year))) group by `tpch`.`nation`.`n_name` order by `revenue` desc                                                                                                     |
| select sum((`tpch`.`lineitem`.`l_extendedprice` * `tpch`.`lineitem`.`l_discount`)) AS `revenue` from `tpch`.`lineitem` where ((`tpch`.`lineitem`.`l_shipdate` >= DATE'1993-01-01') and (`tpch`.`lineitem`.`l_shipdate` < (DATE'1993-01-01' + interval '1' year)) and (`tpch`.`lineitem`.`l_discount` between (0.06 - 0.01) and (0.06 + 0.01)) and (`tpch`.`lineitem`.`l_quantity` < 24))                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| select `shipping`.`supp_nation` AS `supp_nation`,`shipping`.`cust_nation` AS `cust_nation`,`shipping`.`l_year` AS `l_year`,sum(`shipping`.`volume`) AS `revenue` from (select `n1`.`n_name` AS `supp_nation`,`n2`.`n_name` AS `cust_nation`,extract(year from `tpch`.`lineitem`.`l_shipdate`) AS `l_year`,(`tpch`.`lineitem`.`l_extendedprice` * (1 - `tpch`.`lineitem`.`l_discount`)) AS `volume` from `tpch`.`supplier` join `tpch`.`lineitem` join `tpch`.`orders` join `tpch`.`customer` join `tpch`.`nation` `n1` join `tpch`.`nation` `n2` where ((`tpch`.`supplier`.`s_suppkey` = `tpch`.`lineitem`.`l_suppkey`) and (`tpch`.`orders`.`o_orderkey` = `tpch`.`lineitem`.`l_orderkey`) and (`tpch`.`customer`.`c_custkey` = `tpch`.`orders`.`o_custkey`) and (`tpch`.`supplier`.`s_nationkey` = `n1`.`n_nationkey`) and (`tpch`.`customer`.`c_nationkey` = `n2`.`n_nationkey`) and (((`n1`.`n_name` = 'JAPAN') and (`n2`.`n_name` = 'INDIA')) or ((`n1`.`n_name` = 'INDIA') and (`n2`.`n_name` = 'JAPAN'))) and (`tpch`.`lineitem`.`l_shipdate` between DATE'1995-01-01' and DATE'1996-12-31'))) `shipping` group by `shipping`.`supp_nation`,`shipping`.`cust_nation`,`shipping`.`l_year` order by `shipping`.`supp_nation`,`shipping`.`cust_nation`,`shipping`.`l_year` |
| select `all_nations`.`o_year` AS `o_year`,(sum((case when (`all_nations`.`nation` = 'INDIA') then `all_nations`.`volume` else 0 end)) / sum(`all_nations`.`volume`)) AS `mkt_share` from (select extract(year from `tpch`.`orders`.`o_orderdate`) AS `o_year`,(`tpch`.`lineitem`.`l_extendedprice` * (1 - `tpch`.`lineitem`.`l_discount`)) AS `volume`,`n2`.`n_name` AS `nation` from `tpch`.`part` join `tpch`.`supplier` join `tpch`.`lineitem` join `tpch`.`orders` join `tpch`.`customer` join `tpch`.`nation` `n1` join `tpch`.`nation` `n2` join `tpch`.`region` where ((`tpch`.`part`.`p_partkey` = `tpch`.`lineitem`.`l_partkey`) and (`tpch`.`supplier`.`s_suppkey` = `tpch`.`lineitem`.`l_suppkey`) and (`tpch`.`lineitem`.`l_orderkey` = `tpch`.`orders`.`o_orderkey`) and (`tpch`.`orders`.`o_custkey` = `tpch`.`customer`.`c_custkey`) and (`tpch`.`customer`.`c_nationkey` = `n1`.`n_nationkey`) and (`n1`.`n_regionkey` = `tpch`.`region`.`r_regionkey`) and (`tpch`.`region`.`r_name` = 'ASIA') and (`tpch`.`supplier`.`s_nationkey` = `n2`.`n_nationkey`) and (`tpch`.`orders`.`o_orderdate` between DATE'1995-01-01' and DATE'1996-12-31') and (`tpch`.`part`.`p_type` = 'SMALL PLATED COPPER'))) `all_nations` group by `all_nations`.`o_year` order by `all_nations`.`o_year` |
| select `profit`.`nation` AS `nation`,`profit`.`o_year` AS `o_year`,sum(`profit`.`amount`) AS `sum_profit` from (select `tpch`.`nation`.`n_name` AS `nation`,extract(year from `tpch`.`orders`.`o_orderdate`) AS `o_year`,((`tpch`.`lineitem`.`l_extendedprice` * (1 - `tpch`.`lineitem`.`l_discount`)) - (`tpch`.`partsupp`.`ps_supplycost` * `tpch`.`lineitem`.`l_quantity`)) AS `amount` from `tpch`.`part` join `tpch`.`supplier` join `tpch`.`lineitem` join `tpch`.`partsupp` join `tpch`.`orders` join `tpch`.`nation` where ((`tpch`.`supplier`.`s_suppkey` = `tpch`.`lineitem`.`l_suppkey`) and (`tpch`.`partsupp`.`ps_suppkey` = `tpch`.`lineitem`.`l_suppkey`) and (`tpch`.`partsupp`.`ps_partkey` = `tpch`.`lineitem`.`l_partkey`) and (`tpch`.`part`.`p_partkey` = `tpch`.`lineitem`.`l_partkey`) and (`tpch`.`orders`.`o_orderkey` = `tpch`.`lineitem`.`l_orderkey`) and (`tpch`.`supplier`.`s_nationkey` = `tpch`.`nation`.`n_nationkey`) and (`tpch`.`part`.`p_name` like '%dim%'))) `profit` group by `profit`.`nation`,`profit`.`o_year` order by `profit`.`nation`,`profit`.`o_year` desc |
| select `tpch`.`lineitem`.`l_suppkey` AS `supplier_no`,sum((`tpch`.`lineitem`.`l_extendedprice` * (1 - `tpch`.`lineitem`.`l_discount`))) AS `total_revenue` from `tpch`.`lineitem` where ((`tpch`.`lineitem`.`l_shipdate` >= DATE'1997-07-01') and (`tpch`.`lineitem`.`l_shipdate` < (DATE'1997-07-01' + interval '3' month))) group by `tpch`.`lineitem`.`l_suppkey` 
